{"ast":null,"code":"var _jsxFileName = \"/Users/samirwankhede/Coding Stuff/Brainop Technology internship interview project/frontend/src/pages/Posts.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef, useCallback } from 'react';\nimport Header from '../components/Header';\nimport PostCard from '../components/PostCard';\nimport Loader from '../common/Loader/Loader';\nimport { useAuthContext } from '../hooks/useAuthContext';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst PAGE_NUMBER = 1;\nexport default function Posts() {\n  _s();\n  const [postData, setPostData] = useState([]);\n  const [page, setPage] = useState(PAGE_NUMBER);\n  const [pageSize, setPageSize] = useState(12);\n  const [loading, setLoading] = useState(true);\n  const [notend, setNotEnd] = useState(false);\n  const {\n    user\n  } = useAuthContext();\n  const observer = useRef();\n  const lastPostRef = useCallback(node => {\n    if (loading) return;\n    if (observer.current) {\n      observer.current.disconnect();\n    }\n    observer.current = new IntersectionObserver(entries => {\n      if (entries[0].isIntersecting && notend) {\n        setPage(prev => prev + 1);\n      }\n    });\n    if (node) observer.current.observe(node);\n  }, [loading, notend]);\n  useEffect(() => {\n    setLoading(true);\n    const fetchdata = async () => {\n      const response = await fetch(`http://localhost:4000/posts?pageSize=${pageSize}&page=${page}`, {\n        credentials: 'include'\n      });\n      const json = await response.json();\n      if (json.rows > 0) {\n        setNotEnd(true);\n      }\n      setPostData(prev => {\n        return [...prev, ...json.rows];\n      });\n      setLoading(false);\n    };\n    if (user) {\n      fetchdata();\n    }\n  }, [page]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Header, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 55,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container my-12 mx-auto px-4 md:px-12\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex flex-wrap -mx-1 lg:-mx-4\",\n        children: postData.map((post, index) => {\n          if (postData.length === index + 1) {\n            return /*#__PURE__*/_jsxDEV(PostCard, {\n              passref: lastPostRef,\n              photo: post.photo_image_url,\n              caption: post.photo_description,\n              location: post.photo_location_name,\n              date: post.photo_submitted_at,\n              alt: post.ai_description,\n              username: post.photographer_username\n            }, index, false, {\n              fileName: _jsxFileName,\n              lineNumber: 61,\n              columnNumber: 11\n            }, this);\n          } else {\n            return /*#__PURE__*/_jsxDEV(PostCard, {\n              photo: post.photo_image_url,\n              caption: post.photo_description,\n              location: post.photo_location_name,\n              date: post.photo_submitted_at,\n              alt: post.ai_description,\n              username: post.photographer_username\n            }, index, false, {\n              fileName: _jsxFileName,\n              lineNumber: 74,\n              columnNumber: 13\n            }, this);\n          }\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 57,\n        columnNumber: 5\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex w-screen align-bottom justify-center items-center\",\n      children: loading && /*#__PURE__*/_jsxDEV(Loader, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 19\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 5\n    }, this)]\n  }, void 0, true);\n}\n_s(Posts, \"TpLnO7NLfOVBP35CPSyX1Xcxu4s=\", false, function () {\n  return [useAuthContext];\n});\n_c = Posts;\nvar _c;\n$RefreshReg$(_c, \"Posts\");","map":{"version":3,"names":["React","useState","useEffect","useRef","useCallback","Header","PostCard","Loader","useAuthContext","jsxDEV","_jsxDEV","Fragment","_Fragment","PAGE_NUMBER","Posts","_s","postData","setPostData","page","setPage","pageSize","setPageSize","loading","setLoading","notend","setNotEnd","user","observer","lastPostRef","node","current","disconnect","IntersectionObserver","entries","isIntersecting","prev","observe","fetchdata","response","fetch","credentials","json","rows","children","fileName","_jsxFileName","lineNumber","columnNumber","className","map","post","index","length","passref","photo","photo_image_url","caption","photo_description","location","photo_location_name","date","photo_submitted_at","alt","ai_description","username","photographer_username","_c","$RefreshReg$"],"sources":["/Users/samirwankhede/Coding Stuff/Brainop Technology internship interview project/frontend/src/pages/Posts.tsx"],"sourcesContent":["import React,{useState, useEffect, useRef, useCallback} from 'react'\nimport Header from '../components/Header'\nimport PostCard from '../components/PostCard';\nimport Loader from '../common/Loader/Loader';\nimport { useAuthContext } from '../hooks/useAuthContext';\n\nconst PAGE_NUMBER = 1;\n\nexport default function Posts() {\n  const [postData, setPostData] = useState<any>([]);\n    const [page, setPage] = useState(PAGE_NUMBER);\n    const [pageSize, setPageSize] = useState(12)\n    const [loading, setLoading] = useState(true);\n    const [notend, setNotEnd] = useState(false)\n    const {user} = useAuthContext();\n\n  const observer = useRef<any>()\n  const lastPostRef = useCallback((node: any) => {\n    if (loading) return\n    if (observer.current) {observer.current.disconnect()}\n    observer.current = new IntersectionObserver(entries => {\n      if (entries[0].isIntersecting && notend) {\n        setPage(prev => prev + 1)\n      }\n    })\n    if (node) observer.current.observe(node)\n  }, [loading, notend])\n\n    useEffect(() => {\n      setLoading(true)\n      const fetchdata = async() => {\n        const response = await fetch(\n          `http://localhost:4000/posts?pageSize=${pageSize}&page=${page}`,{\n          credentials: 'include',\n        }\n      );\n      const json =  await response.json()\n      if (json.rows>0){\n        setNotEnd(true)\n      }\n      setPostData((prev:any) => {\n        return [...prev, ...json.rows];\n      });\n      setLoading(false);\n      }\n      if (user){\n        fetchdata();\n      }\n      \n    }, [page]);\n\n    \n  return (\n    <>\n    <Header/> \n    <div className=\"container my-12 mx-auto px-4 md:px-12\">\n    <div className=\"flex flex-wrap -mx-1 lg:-mx-4\">\n       { postData.map((post:any,index:number)=> {\n        if (postData.length === index+1){\n         return(\n          <PostCard\n            passref = {lastPostRef}\n            key={index}\n            photo = {post.photo_image_url} \n            caption = {post.photo_description}\n            location = {post.photo_location_name}\n            date = {post.photo_submitted_at}\n            alt = {post.ai_description}\n            username = {post.photographer_username}\n        />)\n        }\n        else{\n          return(\n            <PostCard\n              key={index}\n              photo = {post.photo_image_url} \n              caption = {post.photo_description}\n              location = {post.photo_location_name}\n              date = {post.photo_submitted_at}\n              alt = {post.ai_description}\n              username = {post.photographer_username}\n          />)\n        }\n       })\n       }\n    </div>\n    </div>\n    <div className='flex w-screen align-bottom justify-center items-center'>\n      {loading && <Loader/>}\n    </div>\n    \n    </>\n  )\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}